<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#FFD700" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>RB TAXI – Výčetka</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css?v=v13_hardfix_20250821103429?v=v12_svg_icons_20250821102256?v=v10_ultra_fix_20250820194050?v=v9_ultra_20250820192037" />
  <link rel="icon" href="icon-192.png" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@600&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script defer src="app.js?v=v13_hardfix_20250821103429?v=v10_ultra_fix_20250820194050?v=v9_ultra_20250820192037"></script>

    <style id="captureStyles">
      /* capture-export styles */
      .capture-export, .capture-export * {
        color: #111 !important;
        background: #ffffff !important;
        box-shadow: none !important;
        text-shadow: none !important;
        -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
      }
      .capture-export .accent-odev .val,
      .capture-export .accent-pay .val,
      .capture-export .accent-doplatek .val {
        font-weight: 700;
      }
      .capture-export .row { border-color: #ccc !important; }
    </style>


<style id="receiptThemeSynced">
/* LIGHT as default tokens (align to app scale) */
#output.receipt-card {
  /* inherit app's font stack & size */
  font-family: inherit;
  font-size: 1rem; /* 16px base to match app */
  --card-bg: #ffffff;
  --card-fg: #1b1f23;
  --muted:   #6b7280;
  --divider: #e5e7eb;

  --gold-1: #f5d36a;
  --gold-2: #e0b956;

  /* accent palettes for light */
  --band-green:  #166534;
  --band-green-bg0: #e8f5ed;
  --band-green-bg1: #def0e6;
  --band-blue:   #1d4ed8;
  --band-blue-bg0:  #e8efff;
  --band-blue-bg1:  #dee7ff;
  --band-red:    #b91c1c;
  --band-red-bg0:   #ffe8e8;
  --band-red-bg1:   #ffdbdb;
}

/* DARK overrides (supports data-theme="dark" or .dark or prefers-color-scheme) */
[data-theme="dark"] #output.receipt-card,
.dark #output.receipt-card {
  --card-bg: #141517;
  --card-fg: #e5e7eb;
  --muted:   #a0a6ae;
  --divider: #2a2e33;

  --band-green:  #34a853;
  --band-green-bg0: #1a332a;
  --band-green-bg1: #10241c;
  --band-blue:   #1a73e8;
  --band-blue-bg0:  #172646;
  --band-blue-bg1:  #0f1c38;
  --band-red:    #d93025;
  --band-red-bg0:   #3a1f1f;
  --band-red-bg1:   #281212;
}
@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]) #output.receipt-card {
    --card-bg: #141517;
    --card-fg: #e5e7eb;
    --muted:   #a0a6ae;
    --divider: #2a2e33;

    --band-green:  #34a853;
    --band-green-bg0: #1a332a;
    --band-green-bg1: #10241c;
    --band-blue:   #1a73e8;
    --band-blue-bg0:  #172646;
    --band-blue-bg1:  #0f1c38;
    --band-red:    #d93025;
    --band-red-bg0:   #3a1f1f;
    --band-red-bg1:   #281212;
  }
}

/* Card container */
#output.receipt-card {
  border-radius: 16px;
  border: 1px solid var(--divider);
  padding: 16px 18px 12px;
  background: var(--card-bg);
  color: var(--card-fg);
  box-shadow:
    0 1px 3px rgba(0,0,0,.08),
    0 4px 12px rgba(0,0,0,.06);
  position: relative;
  isolation: isolate;
}

/* Gold strip */
#output.receipt-card::before{
  content:"";
  display:block;
  height: 22px;
  margin: -4px 0 12px;
  border-radius: 10px;
  background: linear-gradient(90deg,var(--gold-1) 0%, var(--gold-2) 100%);
}

/* Typography – synced with app scale */
#output.receipt-card .title{
  font-size: 1.25rem; /* 20px */
  font-weight: 800;
  margin: 0 0 8px;
}
#output.receipt-card .row{
  display:flex; align-items:baseline; justify-content:space-between; gap:12px;
  padding: 6px 0;
  border-bottom: 1px solid transparent;
}
#output.receipt-card .row.keyval{ border-bottom-color: var(--divider); }

#output.receipt-card .key{
  font-size: 1rem;   /* 16px */
  font-weight: 700;
  color: var(--card-fg);
}
#output.receipt-card .val{
  font-size: 1rem;   /* 16px */
  font-weight: 600;
  color: var(--card-fg);
}
#output.receipt-card .muted .key,
#output.receipt-card .muted .val{ color: var(--muted); }

/* totals */
#output.receipt-card .totals{ margin-top: 10px; }
#output.receipt-card .totals .val{ font-weight: 700; font-size: 1.0625rem; } /* 17px */

/* Accent bands (light & dark via variables) */
#output.receipt-card .row.accent-odev{
  background: linear-gradient(0deg,var(--band-green-bg0) 0%, var(--band-green-bg1) 100%);
  border-left: 6px solid var(--band-green);
  border-radius: 6px;
  padding: 8px 10px;
  margin: 8px 0;
}
#output.receipt-card .row.accent-pay{
  background: linear-gradient(0deg,var(--band-blue-bg0) 0%, var(--band-blue-bg1) 100%);
  border-left: 6px solid var(--band-blue);
  border-radius: 6px;
  padding: 8px 10px;
  margin: 8px 0;
}
#output.receipt-card .row.accent-doplatek{
  background: linear-gradient(0deg,var(--band-red-bg0) 0%, var(--band-red-bg1) 100%);
  border-left: 6px solid var(--band-red);
  border-radius: 6px;
  padding: 8px 10px;
  margin: 8px 0;
}

/* Ensure full contrast (no faded text) */
#output.receipt-card, #output.receipt-card *{
  -webkit-text-fill-color: currentColor;
  opacity: 1;
  mix-blend-mode: normal;
  text-shadow: none;
}

/* Export snapshot equals on-screen theme */
.capture-export#output.receipt-card{
  background: var(--card-bg) !important;
  color: var(--card-fg) !important;
}
.capture-export#output.receipt-card, .capture-export#output.receipt-card *{
  -webkit-text-fill-color: currentColor !important;
  opacity: 1 !important;
  filter: none !important;
  mix-blend-mode: normal !important;
  text-shadow: none !important;
  box-shadow: none !important;
}
</style>

</head>
<body>

<!-- SVG ICON SPRITE -->
<svg xmlns="http://www.w3.org/2000/svg" style="position:absolute;width:0;height:0;overflow:hidden" aria-hidden="true">
  <symbol id="icon-user" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M20 21a8 8 0 0 0-16 0" /><circle cx="12" cy="7" r="4" />
  </symbol>
  <symbol id="icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="9"/><path d="M12 7v6l4 2"/>
  </symbol>
  <symbol id="icon-road" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 20l6-16 4 16 6-16" /><path d="M12 4v4m0 4v4m0 4v0"/>
  </symbol>
  <symbol id="icon-cash" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="3" y="6" width="18" height="12" rx="2"/><circle cx="12" cy="12" r="2"/>
  </symbol>
  <symbol id="icon-flag" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 22V4h8l1 3h7v9h-9l-1-3H4z"/>
  </symbol>
  <symbol id="icon-fuel" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="3" y="6" width="10" height="14" rx="2"/><path d="M14 9l4-2v7a3 3 0 1 0 6 0V9l-2-2-2 1" transform="translate(-4 0)"/>
  </symbol>
  <symbol id="icon-wash" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M12 3c-1.5 2-5 6-5 9a5 5 0 0 0 10 0c0-3-3.5-7-5-9z"/>
  </symbol>
  <symbol id="icon-card" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="5" width="20" height="14" rx="2"/><path d="M2 10h20"/>
  </symbol>
  <symbol id="icon-doc" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/>
  </symbol>
  <symbol id="icon-box" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 16V8l-9-5-9 5v8l9 5 9-5z"/><path d="M3.5 7.5l9 5 9-5"/>
  </symbol>
  <symbol id="icon-calc" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="4" y="3" width="16" height="18" rx="2"/><path d="M8 7h8M8 11h8M8 15h3"/>
  </symbol>
  <symbol id="icon-refresh" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M3 12a9 9 0 0 1 15-6l2 2M21 12a9 9 0 0 1-15 6l-2-2"/><path d="M21 4v6h-6"/>
  </symbol>
  <symbol id="icon-share" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><path d="M8.7 13.4l6.6 3.2M15.3 7.4L8.7 10.6"/>
  </symbol>
  <symbol id="icon-repeat" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M17 1l4 4-4 4M3 11V9a6 6 0 0 1 6-6h12"/><path d="M7 23l-4-4 4-4M21 13v2a6 6 0 0 1-6 6H3"/>
  </symbol>
  <symbol id="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M2 12h2M20 12h2M4.9 4.9l1.4 1.4M17.7 17.7l1.4 1.4M4.9 19.1l1.4-1.4M17.7 6.3l1.4-1.4"/>
  </symbol>
  <symbol id="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
  </symbol>
</svg>

  <header>
    <h1><img src="icon-192.png" alt="RB TAXI" class="brand-icon" /> <span class="brand-title">Výčetka řidiče</span></h1>
    <div id="themeToggle"><span class="ico"><svg class="icon"><use href="#icon-moon"/></svg></span> Přepnout režim</div>
  </header>
  <main>
    <form id="calcForm">
      <label><span class="ico"><svg class="icon"><use href="#icon-user"/></svg></span> Řidič: <input type="text" id="driverName" placeholder="Jméno řidiče" required /></label>
      <label><span class="ico"><svg class="icon"><use href="#icon-clock"/></svg></span> Typ směny:
        <select id="shiftType">
          <option value="den">Denní</option>
          <option value="noc">Noční</option>
          <option value="odpo">Odpolední</option>
          <option value="pul">1/2 směna</option>
        </select>
      </label>
      <label><span class="ico"><svg class="icon"><use href="#icon-car"/></svg></span> RZ vozidla:
        <select id="rz">
          <option value="">— vyberte RZ —</option>
          <option>1BS2008</option>
          <option>1BT9883</option>
          <option>1BU0299</option>
          <option>1BU0060</option>
          <option>2BT6881</option>
          <option>2BY5398</option>
          <option>2BL8995</option>
          <option>3BD6003</option>
        </select>
      </label>
      <label><span class="ico"><svg class="icon"><use href="#icon-flag"/></svg></span> Počáteční km:
        <input type="number" id="kmStart" inputmode="numeric" />
      </label>
      <label><span class="ico"><svg class="icon"><use href="#icon-flag"/></svg></span> Konečné km:
        <input type="number" id="kmEnd" inputmode="numeric" />
      </label>
      <label><span class="ico"><svg class="icon"><use href="#icon-road"/></svg></span> Najeté km (auto):
        <input type="number" id="kmReal" readonly />
      </label>
      <label><span class="ico"><svg class="icon"><use href="#icon-cash"/></svg></span> Tržba: <input type="number" id="trzba" required /></label>
      <label><span class="ico"><svg class="icon"><use href="#icon-flag"/></svg></span> Přístavné: <input type="number" id="pristavne" /></label>
      <label><span class="ico"><svg class="icon"><use href="#icon-fuel"/></svg></span> Palivo: <input type="number" id="palivo" /></label>
      <label><span class="ico"><svg class="icon"><use href="#icon-wash"/></svg></span> Mytí: <input type="number" id="myti" /></label>
      <label><span class="ico"><svg class="icon"><use href="#icon-card"/></svg></span> Kartou: <input type="number" id="kartou" /></label>
      <label>🧾 Fakturou: <input type="number" id="fakturou" /></label>
      <label><span class="ico"><svg class="icon"><use href="#icon-box"/></svg></span> Jiné: <input type="number" id="jine" /></label>

      <div class="form-actions">
        <button type="submit"><svg class="icon"><use href="#icon-calc"/></svg> Vypočítat</button>
        <button type="button" id="resetBtn"><svg class="icon"><use href="#icon-refresh"/></svg> Reset</button>
        
      </div>
    </form>

    <section id="output" class="hidden"></section>
    <div id="actions" class="hidden">
      <button type="button" id="newShiftBtn"><svg class="icon"><use href="#icon-repeat"/></svg> Nová směna</button>
    
        <button type="button" id="shareImgBtn" title="Sdílet výčetku jako obrázek">Sdílet výčetku</button></div>
  
    <footer id="appVersion" style="text-align:center;color:#9aa0a6;margin:10px 0;font-size:12px;">RB TAXI Mobile v9_ultra_20250820192037</footer>
</main>

<script>
document.addEventListener('DOMContentLoaded', function(){
  try {
    var btn = document.getElementById('shareImgBtn');
    if (!btn) return;
    var clone = btn.cloneNode(true);
    btn.parentNode.replaceChild(clone, btn);
    btn = clone;

    btn.addEventListener('click', function(ev){
      ev.preventDefault(); ev.stopImmediatePropagation();
      try { if (typeof computeAndRender === 'function') computeAndRender(); } catch(_){}

      var output = document.getElementById('output') || document.querySelector('.output') || document.body;
      if (!output || typeof html2canvas === 'undefined') return;

      var root = document.documentElement;
      var prevTheme = root.getAttribute('data-theme');
      root.setAttribute('data-theme', 'light');
      output.classList.add('capture-export');

      var scale = Math.max(2, Math.floor(window.devicePixelRatio || 2)) + 1;
      html2canvas(output, { scale: scale, backgroundColor: '#ffffff', useCORS: true })
        .then(function(canvas){
          return new Promise(function(resolve, reject){
            canvas.toBlob(function(blob){
              if (!blob) return reject(new Error('PNG se nepodařilo vytvořit.'));
              var file = new File([blob], 'vycetka.png', { type: 'image/png' });

              if (navigator.canShare && navigator.canShare({ files: [file] })) {
                navigator.share({ files: [file], title: 'Výčetka řidiče', text: 'Výčetka řidiče (PNG)' }).then(resolve).catch(reject);
              } else if (navigator.clipboard && window.ClipboardItem) {
                navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })])
                  .then(function(){ alert('Obrázek výčetky byl zkopírován do schránky.'); resolve(); })
                  .catch(function(){
                    var url = URL.createObjectURL(blob);
                    var a = document.createElement('a'); a.href = url; a.download = 'vycetka.png';
                    document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
                    resolve();
                  });
              } else {
                var url = URL.createObjectURL(blob);
                var a = document.createElement('a'); a.href = url; a.download = 'vycetka.png';
                document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
                resolve();
              }
            }, 'image/png');
          });
        })
        .catch(function(e){ alert('Sdílení obrázku selhalo: ' + (e && e.message ? e.message : e)); })
        .finally(function(){
          output.classList.remove('capture-export');
          if (prevTheme !== null) root.setAttribute('data-theme', prevTheme);
          else root.removeAttribute('data-theme');
        });
    }, true);
  } catch(e) {}
});
</script>


<script>
document.addEventListener('DOMContentLoaded', function(){
  var out = document.getElementById('output');
  if (out && !out.classList.contains('receipt-card')) out.classList.add('receipt-card');
});
</script>

</body>
</html>